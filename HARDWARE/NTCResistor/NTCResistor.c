#include "NTCResistor/NTCResistor.h"
#include "NTCResistor/adc.h"
#include "../USER/cPrintf.h"

#include "../HMI/cmd_process.h"
#include "../UILogic/pageCommon.h"
#include "../Logic/managerment.h"

//////////////////////////////////////////////////////////////////////////////////	 
//本程序只供学习使用，未经作者许可，不得用于其它任何用途
//ALIENTEK战舰STM32开发板
//蜂鸣器驱动代码	   
//正点原子@ALIENTEK
//技术论坛:www.openedv.com
//修改日期:2012/9/2
//版本：V1.0
//版权所有，盗版必究。
//Copyright(C) 广州市星翼电子科技有限公司 2009-2019
//All rights reserved									  
////////////////////////////////////////////////////////////////////////////////// 	   

#define FILTERORDER 4

uint16_t adcBuff[3];
uint16_t arrayBuff[3][FILTERORDER];

ADCResTemp_TypeDef adcTemp[3];

//NTCResistor_T_R_TypeDef NTCResistor_50K3950_Table[] = 
//{
//	{	-40	,	1424.00	},
//	{	-39	,	1344.00	},
//	{	-38	,	1269.00	},
//	{	-37	,	1199.00	},
//	{	-36	,	1132.00	},
//	{	-35	,	1070.00	},
//	{	-34	,	1011.00	},
//	{	-33	,	955.20	},
//	{	-32	,	902.90	},
//	{	-31	,	853.50	},
//	{	-30	,	807.00	},
//	{	-29	,	763.00	},
//	{	-28	,	721.80	},
//	{	-27	,	682.70	},
//	{	-26	,	645.90	},
//	{	-25	,	611.20	},
//	{	-24	,	578.40	},
//	{	-23	,	547.50	},
//	{	-22	,	518.30	},
//	{	-21	,	490.80	},
//	{	-20	,	464.70	},
//	{	-19	,	439.50	},
//	{	-18	,	415.70	},
//	{	-17	,	393.40	},
//	{	-16	,	372.30	},
//	{	-15	,	352.50	},
//	{	-14	,	333.90	},
//	{	-13	,	316.40	},
//	{	-12	,	299.80	},
//	{	-11	,	284.30	},
//	{	-10	,	269.60	},
//	{	-9	,	255.70	},
//	{	-8	,	242.70	},
//	{	-7	,	230.30	},
//	{	-6	,	218.70	},
//	{	-5	,	207.70	},
//	{	-4	,	197.70	},
//	{	-3	,	187.50	},
//	{	-2	,	178.30	},
//	{	-1	,	169.50	},
//	{	0	,	161.20	},
//	{	1	,	153.40	},
//	{	2	,	145.90	},
//	{	3	,	138.90	},
//	{	4	,	132.30	},
//	{	5	,	126.00	},
//	{	6	,	120.00	},
//	{	7	,	114.30	},
//	{	8	,	109.00	},
//	{	9	,	103.90	},
//	{	10	,	99.08	},
//	{	11	,	94.51	},
//	{	12	,	90.17	},
//	{	13	,	86.05	},
//	{	14	,	82.14	},
//	{	15	,	78.42	},
//	{	16	,	74.89	},
//	{	17	,	71.54	},
//	{	18	,	68.35	},
//	{	19	,	65.32	},
//	{	20	,	62.440 	},
//	{	21	,	59.700 	},
//	{	22	,	57.090 	},
//	{	23	,	54.610 	},
//	{	24	,	52.250 	},
//	{	25	,	50.000 	},
//	{	26	,	47.870 	},
//	{	27	,	45.840 	},
//	{	28	,	43.910 	},
//	{	29	,	42.080 	},
//	{	30	,	40.330 	},
//	{	31	,	38.660 	},
//	{	32	,	37.070 	},
//	{	33	,	35.550 	},
//	{	34	,	34.110 	},
//	{	35	,	32.730 	},
//	{	36	,	31.410 	},
//	{	37	,	30.150 	},
//	{	38	,	28.950 	},
//	{	39	,	27.810 	},
//	{	40	,	26.720 	},
//	{	41	,	25.670 	},
//	{	42	,	24.670 	},
//	{	43	,	23.720 	},
//	{	44	,	22.810 	},
//	{	45	,	21.930 	},
//	{	46	,	21.100 	},
//	{	47	,	20.300 	},
//	{	48	,	19.540 	},
//	{	49	,	18.810 	},
//	{	50	,	18.110	},
//	{	51	,	17.440	},
//	{	52	,	16.790	},
//	{	53	,	16.180	},
//	{	54	,	15.590	},
//	{	55	,	15.020	},
//	{	56	,	14.480	},
//	{	57	,	13.960	},
//	{	58	,	13.460	},
//	{	59	,	12.990	},
//	{	60	,	12.530	},
//	{	61	,	12.090	},
//	{	62	,	22.670	},
//	{	63	,	11.260	},
//	{	64	,	10.870	},
//	{	65	,	10.500	},
//	{	66	,	10.140	},
//	{	67	,	9.792	},
//	{	68	,	9.460	},
//	{	69	,	9.141	},
//	{	70	,	8.834	},
//	{	71	,	8.539	},
//	{	72	,	8.256	},
//	{	73	,	7.983	},
//	{	74	,	7.720	},
//	{	75	,	7.468	},
//	{	76	,	7.225	},
//	{	77	,	6.991	},
//	{	78	,	6.765	},
//	{	79	,	6.548	},
//	{	80	,	6.3390 	},
//	{	81	,	6.1380 	},
//	{	82	,	5.9440 	},
//	{	83	,	5.7570 	},
//	{	84	,	5.5770 	},
//	{	85	,	5.4030 	},
//	{	86	,	5.2370 	},
//	{	87	,	5.0760 	},
//	{	88	,	4.9210 	},
//	{	89	,	4.7720 	},
//	{	90	,	4.6280 	},
//	{	91	,	4.4890 	},
//	{	92	,	4.3540 	},
//	{	93	,	4.2250 	},
//	{	94	,	4.0990 	},
//	{	95	,	3.9780 	},
//	{	96	,	9.8610 	},
//	{	97	,	3.7480 	},
//	{	98	,	3.6390 	},
//	{	99	,	3.5340 	},
//	{	100	,	3.4320 	},
//	{	101	,	3.3330 	},
//	{	102	,	3.2380 	},
//	{	103	,	3.1460 	},
//	{	104	,	3.0560 	},
//	{	105	,	2.9700 	},
//	{	106	,	2.8870 	},
//	{	107	,	2.8060 	},
//	{	108	,	2.7280 	},
//	{	109	,	2.6520 	},
//	{	110	,	2.5790	},
//	{	111	,	2.5080	},
//	{	112	,	2.3730	},
//	{	113	,	2.3080	},
//	{	114	,	2.2460	},
//	{	115	,	2.1860	},
//	{	116	,	2.1270	},
//	{	117	,	2.0700	},
//	{	118	,	2.0150	},
//	{	119	,	1.9620	},
//	{	120	,	1.9100	},
//	{	121	,	1.8600	},
//	{	122	,	1.8120	},
//	{	123	,	1.7650	},
//	{	124	,	1.7190	},
//	{	125	,	0.3454	},
//	{	126	,	1.6750	},
//	{	127	,	1.6320	},
//	{	128	,	1.5900	},
//	{	129	,	1.5500	},
//	{	130	,	1.5110	},
//	{	131	,	1.4730	},
//	{	132	,	1.4360	},
//	{	133	,	1.4000	},
//	{	134	,	1.3650	},
//	{	135	,	1.3310	},
//	{	136	,	1.2990	},
//	{	137	,	1.2670	},
//	{	138	,	1.2360	},
//	{	139	,	1.2060	},
//	{	140	,	1.1770 	},
//	{	141	,	1.1480 	},
//	{	142	,	1.1210 	},
//	{	143	,	1.0940 	},
//	{	144	,	1.0680 	},
//	{	145	,	1.0430 	},
//	{	146	,	1.0180 	},
//	{	147	,	0.9945 	},
//	{	148	,	0.9713 	},
//	{	149	,	0.9488 	},
//	{	150	,	0.9268 	},
//	{	151	,	0.9052 	},
//	{	152	,	0.8843 	},
//	{	153	,	0.8639 	},
//	{	154	,	0.8440 	},
//	{	155	,	0.8248 	},
//	{	156	,	0.8060 	},
//	{	157	,	0.7878 	},
//	{	158	,	0.7701 	},
//	{	159	,	0.7529 	},
//	{	160	,	0.7361 	},
//	{	161	,	0.7198 	},
//	{	162	,	0.7039 	},
//	{	163	,	0.6885 	},
//	{	164	,	0.6735 	},
//	{	165	,	0.6588 	},
//	{	166	,	0.6446 	},
//	{	167	,	0.6307 	},
//	{	168	,	0.6172 	},
//	{	169	,	0.6041 	},
//	{	170	,	0.5913	},
//};

const NTCResistor_T_R_TypeDef NTCResistor_50K3950_Table[] =   //PtResistor_1K3850_Table
{
	{	-50	,	803.0683842	},
	{	-49	,	807.0390585	},
	{	-48	,	811.0083235	},
	{	-47	,	814.976187	},
	{	-46	,	818.9426563	},
	{	-45	,	822.9077387	},
	{	-44	,	826.8714415	},
	{	-43	,	830.8337718	},
	{	-42	,	834.7947366	},
	{	-41	,	838.7543428	},
	{	-40	,	842.7125974	},
	{	-39	,	846.6695069	},
	{	-38	,	850.625078	},
	{	-37	,	854.5793172	},
	{	-36	,	858.5322309	},
	{	-35	,	862.4838255	},
	{	-34	,	866.4341071	},
	{	-33	,	870.3830819	},
	{	-32	,	874.3307558	},
	{	-31	,	878.2771347	},
	{	-30	,	882.2222245	},
	{	-29	,	886.1660308	},
	{	-28	,	890.1085592	},
	{	-27	,	894.0498152	},
	{	-26	,	897.9898042	},
	{	-25	,	901.9285314	},
	{	-24	,	905.8660021	},
	{	-23	,	909.8022214	},
	{	-22	,	913.7371941	},
	{	-21	,	917.6709252	},
	{	-20	,	921.6034194	},
	{	-19	,	925.5346815	},
	{	-18	,	929.4647159	},
	{	-17	,	933.3935271	},
	{	-16	,	937.3211196	},
	{	-15	,	941.2474975	},
	{	-14	,	945.172665	},
	{	-13	,	949.0966261	},
	{	-12	,	953.0193848	},
	{	-11	,	956.940945	},
	{	-10	,	960.8613104	},
	{	-9	,	964.7804846	},
	{	-8	,	968.6984712	},
	{	-7	,	972.6152736	},
	{	-6	,	976.5308951	},
	{	-5	,	980.445339	},
	{	-4	,	984.3586084	},
	{	-3	,	988.2707064	},
	{	-2	,	992.1816357	},
	{	-1	,	996.0913994	},
	{	0	,	1000	},
	{	1	,	1003.90744	},
	{	2	,	1007.813719	},
	{	3	,	1011.718838	},
	{	4	,	1015.622797	},
	{	5	,	1019.525595	},
	{	6	,	1023.427233	},
	{	7	,	1027.32771	},
	{	8	,	1031.227028	},
	{	9	,	1035.125184	},
	{	10	,	1039.022181	},
	{	11	,	1042.918016	},
	{	12	,	1046.812692	},
	{	13	,	1050.706207	},
	{	14	,	1054.598562	},
	{	15	,	1058.489756	},
	{	16	,	1062.37979	},
	{	17	,	1066.268664	},
	{	18	,	1070.156377	},
	{	19	,	1074.04293	},
	{	20	,	1077.928322	},
	{	21	,	1081.812554	},
	{	22	,	1085.695626	},
	{	23	,	1089.577537	},
	{	24	,	1093.458288	},
	{	25	,	1097.337878	},
	{	26	,	1101.216308	},
	{	27	,	1105.093578	},
	{	28	,	1108.969687	},
	{	29	,	1112.844636	},
	{	30	,	1116.718425	},
	{	31	,	1120.591053	},
	{	32	,	1124.46252	},
	{	33	,	1128.332828	},
	{	34	,	1132.201975	},
	{	35	,	1136.069961	},
	{	36	,	1139.936787	},
	{	37	,	1143.802453	},
	{	38	,	1147.666958	},
	{	39	,	1151.530303	},
	{	40	,	1155.392488	},
	{	41	,	1159.253512	},
	{	42	,	1163.113376	},
	{	43	,	1166.972079	},
	{	44	,	1170.829622	},
	{	45	,	1174.686005	},
	{	46	,	1178.541227	},
	{	47	,	1182.395289	},
	{	48	,	1186.248191	},
	{	49	,	1190.099932	},
	{	50	,	1193.950513	},
	{	51	,	1197.799933	},
	{	52	,	1201.648193	},
	{	53	,	1205.495292	},
	{	54	,	1209.341231	},
	{	55	,	1213.18601	},
	{	56	,	1217.029628	},
	{	57	,	1220.872086	},
	{	58	,	1224.713384	},
	{	59	,	1228.553521	},
	{	60	,	1232.392498	},
	{	61	,	1236.230314	},
	{	62	,	1240.06697	},
	{	63	,	1243.902466	},
	{	64	,	1247.736801	},
	{	65	,	1251.569976	},
	{	66	,	1255.401991	},
	{	67	,	1259.232845	},
	{	68	,	1263.062538	},
	{	69	,	1266.891072	},
	{	70	,	1270.718445	},
	{	71	,	1274.544657	},
	{	72	,	1278.369709	},
	{	73	,	1282.193601	},
	{	74	,	1286.016332	},
	{	75	,	1289.837903	},
	{	76	,	1293.658314	},
	{	77	,	1297.477564	},
	{	78	,	1301.295654	},
	{	79	,	1305.112583	},
	{	80	,	1308.928352	},
	{	81	,	1312.742961	},
	{	82	,	1316.556409	},
	{	83	,	1320.368697	},
	{	84	,	1324.179824	},
	{	85	,	1327.989791	},
	{	86	,	1331.798598	},
	{	87	,	1335.606244	},
	{	88	,	1339.41273	},
	{	89	,	1343.218055	},
	{	90	,	1347.022221	},
	{	91	,	1350.825225	},
	{	92	,	1354.62707	},
	{	93	,	1358.427753	},
	{	94	,	1362.227277	},
	{	95	,	1366.02564	},
	{	96	,	1369.822843	},
	{	97	,	1373.618885	},
	{	98	,	1377.413767	},
	{	99	,	1381.207489	},
	{	100	,	1385.00005	},
	{	101	,	1388.791451	},
	{	102	,	1392.581691	},
	{	103	,	1396.370771	},
	{	104	,	1400.158691	},
	{	105	,	1403.94545	},
	{	106	,	1407.731049	},
	{	107	,	1411.515487	},
	{	108	,	1415.298766	},
	{	109	,	1419.080883	},
	{	110	,	1422.861841	},
	{	111	,	1426.641637	},
	{	112	,	1430.420274	},
	{	113	,	1434.19775	},
	{	114	,	1437.974066	},
	{	115	,	1441.749221	},
	{	116	,	1445.523216	},
	{	117	,	1449.296051	},
	{	118	,	1453.067725	},
	{	119	,	1456.838239	},
	{	120	,	1460.607592	},
	{	121	,	1464.375785	},
	{	122	,	1468.142818	},
	{	123	,	1471.90869	},
	{	124	,	1475.673402	},
	{	125	,	1479.436953	},
	{	126	,	1483.199344	},
	{	127	,	1486.960575	},
	{	128	,	1490.720645	},
	{	129	,	1494.479555	},
	{	130	,	1498.237305	},
	{	131	,	1501.993894	},
	{	132	,	1505.749322	},
	{	133	,	1509.503591	},
	{	134	,	1513.256699	},
	{	135	,	1517.008646	},
	{	136	,	1520.759433	},
	{	137	,	1524.50906	},
	{	138	,	1528.257526	},
	{	139	,	1532.004832	},
	{	140	,	1535.750978	},
	{	141	,	1539.495963	},
	{	142	,	1543.239788	},
	{	143	,	1546.982452	},
	{	144	,	1550.723956	},
	{	145	,	1554.4643	},
	{	146	,	1558.203483	},
	{	147	,	1561.941506	},
	{	148	,	1565.678369	},
	{	149	,	1569.414071	},
	{	150	,	1573.148613	},
	{	151	,	1576.881994	},
	{	152	,	1580.614215	},
	{	153	,	1584.345275	},
	{	154	,	1588.075175	},
	{	155	,	1591.803915	},
	{	156	,	1595.531494	},
	{	157	,	1599.257913	},
	{	158	,	1602.983172	},
	{	159	,	1606.70727	},
	{	160	,	1610.430208	},
	{	161	,	1614.151985	},
	{	162	,	1617.872602	},
	{	163	,	1621.592059	},
	{	164	,	1625.310355	},
	{	165	,	1629.027491	},
	{	166	,	1632.743467	},
	{	167	,	1636.458282	},
	{	168	,	1640.171936	},
	{	169	,	1643.884431	},
	{	170	,	1647.595765	},
	{	171	,	1651.305938	},
	{	172	,	1655.014951	},
	{	173	,	1658.722804	},
	{	174	,	1662.429496	},
	{	175	,	1666.135028	},
	{	176	,	1669.8394	},
	{	177	,	1673.542611	},
	{	178	,	1677.244662	},
	{	179	,	1680.945552	},
	{	180	,	1684.645282	},
	{	181	,	1688.343852	},
	{	182	,	1692.041261	},
	{	183	,	1695.73751	},
	{	184	,	1699.432598	},
	{	185	,	1703.126526	},
	{	186	,	1706.819294	},
	{	187	,	1710.510901	},
	{	188	,	1714.201348	},
	{	189	,	1717.890634	},
	{	190	,	1721.578761	},
	{	191	,	1725.265726	},
	{	192	,	1728.951532	},
	{	193	,	1732.636176	},
	{	194	,	1736.319661	},
	{	195	,	1740.001985	},
	{	196	,	1743.683149	},
	{	197	,	1747.363152	},
	{	198	,	1751.041995	},
	{	199	,	1754.719678	},
	{	200	,	1758.3962	},
	{	201	,	1762.071562	},
	{	202	,	1765.745763	},
	{	203	,	1769.418804	},
	{	204	,	1773.090685	},
	{	205	,	1776.761405	},
	{	206	,	1780.430965	},
	{	207	,	1784.099364	},
	{	208	,	1787.766604	},
	{	209	,	1791.432682	},
	{	210	,	1795.097601	},
	{	211	,	1798.761358	},
	{	212	,	1802.423956	},
	{	213	,	1806.085393	},
	{	214	,	1809.74567	},
	{	215	,	1813.404786	},
	{	216	,	1817.062742	},
	{	217	,	1820.719538	},
	{	218	,	1824.375173	},
	{	219	,	1828.029648	},
	{	220	,	1831.682962	},
	{	221	,	1835.335116	},
	{	222	,	1838.98611	},
	{	223	,	1842.635943	},
	{	224	,	1846.284616	},
	{	225	,	1849.932128	},
	{	226	,	1853.57848	},
	{	227	,	1857.223672	},
	{	228	,	1860.867703	},
	{	229	,	1864.510574	},
	{	230	,	1868.152285	},
	{	231	,	1871.792835	},
	{	232	,	1875.432224	},
	{	233	,	1879.070454	},
	{	234	,	1882.707523	},
	{	235	,	1886.343431	},
	{	236	,	1889.978179	},
	{	237	,	1893.611767	},
	{	238	,	1897.244194	},
	{	239	,	1900.875461	},
	{	240	,	1904.505568	},
	{	241	,	1908.134514	},
	{	242	,	1911.7623	},
	{	243	,	1915.388925	},
	{	244	,	1919.01439	},
	{	245	,	1922.638695	},
	{	246	,	1926.261839	},
	{	247	,	1929.883823	},
	{	248	,	1933.504647	},
	{	249	,	1937.12431	},
	{	250	,	1940.742813	},
	{	251	,	1944.360155	},
	{	252	,	1947.976337	},
	{	253	,	1951.591358	},
	{	254	,	1955.205219	},
	{	255	,	1958.81792	},
	{	256	,	1962.42946	},
	{	257	,	1966.03984	},
	{	258	,	1969.64906	},
	{	259	,	1973.257119	},
	{	260	,	1976.864018	},
	{	261	,	1980.469756	},
	{	262	,	1984.074334	},
	{	263	,	1987.677752	},
	{	264	,	1991.280009	},
	{	265	,	1994.881106	},
	{	266	,	1998.481043	},
	{	267	,	2002.079819	},
	{	268	,	2005.677434	},
	{	269	,	2009.27389	},
	{	270	,	2012.869185	},
	{	271	,	2016.463319	},
	{	272	,	2020.056293	},
	{	273	,	2023.648107	},
	{	274	,	2027.23876	},
	{	275	,	2030.828253	},
	{	276	,	2034.416586	},
	{	277	,	2038.003758	},
	{	278	,	2041.58977	},
	{	279	,	2045.174621	},
	{	280	,	2048.758312	},
	{	281	,	2052.340843	},
	{	282	,	2055.922213	},
	{	283	,	2059.502423	},
	{	284	,	2063.081472	},
	{	285	,	2066.659361	},
	{	286	,	2070.23609	},
	{	287	,	2073.811658	},
	{	288	,	2077.386066	},
	{	289	,	2080.959313	},
	{	290	,	2084.531401	},
	{	291	,	2088.102327	},
	{	292	,	2091.672094	},
	{	293	,	2095.240699	},
	{	294	,	2098.808145	},
	{	295	,	2102.37443	},
	{	296	,	2105.939555	},
	{	297	,	2109.503519	},
	{	298	,	2113.066323	},
	{	299	,	2116.627967	},
	{	300	,	2120.18845	},
	{	301	,	2123.747773	},
	{	302	,	2127.305935	},
	{	303	,	2130.862937	},
	{	304	,	2134.418779	},
	{	305	,	2137.97346	},
	{	306	,	2141.526981	},
	{	307	,	2145.079341	},
	{	308	,	2148.630542	},
	{	309	,	2152.180581	},
	{	310	,	2155.729461	},
	{	311	,	2159.277179	},
	{	312	,	2162.823738	},
	{	313	,	2166.369136	},
	{	314	,	2169.913374	},
	{	315	,	2173.456451	},
	{	316	,	2176.998368	},
	{	317	,	2180.539125	},
	{	318	,	2184.078721	},
	{	319	,	2187.617157	},
	{	320	,	2191.154432	},
	{	321	,	2194.690547	},
	{	322	,	2198.225502	},
	{	323	,	2201.759296	},
	{	324	,	2205.29193	},
	{	325	,	2208.823403	},
	{	326	,	2212.353716	},
	{	327	,	2215.882869	},
	{	328	,	2219.410861	},
	{	329	,	2222.937693	},
	{	330	,	2226.463365	},
	{	331	,	2229.987876	},
	{	332	,	2233.511226	},
	{	333	,	2237.033417	},
	{	334	,	2240.554447	},
	{	335	,	2244.074316	},
	{	336	,	2247.593025	},
	{	337	,	2251.110574	},
	{	338	,	2254.626962	},
	{	339	,	2258.14219	},
	{	340	,	2261.656258	},
	{	341	,	2265.169165	},
	{	342	,	2268.680912	},
	{	343	,	2272.191498	},
	{	344	,	2275.700924	},
	{	345	,	2279.20919	},
	{	346	,	2282.716295	},
	{	347	,	2286.22224	},
	{	348	,	2289.727025	},
	{	349	,	2293.230649	},
	{	350	,	2296.733113	},
	{	351	,	2300.234416	},
	{	352	,	2303.734559	},
	{	353	,	2307.233541	},
	{	354	,	2310.731363	},
	{	355	,	2314.228025	},
	{	356	,	2317.723526	},
	{	357	,	2321.217867	},
	{	358	,	2324.711048	},
	{	359	,	2328.203068	},
	{	360	,	2331.693928	},
	{	361	,	2335.183627	},
	{	362	,	2338.672166	},
	{	363	,	2342.159545	},
	{	364	,	2345.645763	},
	{	365	,	2349.130821	},
	{	366	,	2352.614719	},
	{	367	,	2356.097456	},
	{	368	,	2359.579032	},
	{	369	,	2363.059449	},
	{	370	,	2366.538705	},
	{	371	,	2370.0168	},
	{	372	,	2373.493735	},
	{	373	,	2376.96951	},
	{	374	,	2380.444124	},
	{	375	,	2383.917578	},
	{	376	,	2387.389872	},
	{	377	,	2390.861005	},
	{	378	,	2394.330978	},
	{	379	,	2397.79979	},
	{	380	,	2401.267442	},
	{	381	,	2404.733934	},
	{	382	,	2408.199265	},
	{	383	,	2411.663436	},
	{	384	,	2415.126446	},
	{	385	,	2418.588296	},
	{	386	,	2422.048986	},
	{	387	,	2425.508515	},
	{	388	,	2428.966884	},
	{	389	,	2432.424092	},
	{	390	,	2435.880141	},
	{	391	,	2439.335028	},
	{	392	,	2442.788756	},
	{	393	,	2446.241322	},
	{	394	,	2449.692729	},
	{	395	,	2453.142975	},
	{	396	,	2456.592061	},
	{	397	,	2460.039986	},
	{	398	,	2463.486751	},
	{	399	,	2466.932356	},
	{	400	,	2470.3768	},
	{	401	,	2473.820084	},
	{	402	,	2477.262207	},
	{	403	,	2480.70317	},
	{	404	,	2484.142973	},
	{	405	,	2487.581615	},
	{	406	,	2491.019097	},
	{	407	,	2494.455418	},
	{	408	,	2497.89058	},
	{	409	,	2501.32458	},
	{	410	,	2504.757421	},
	{	411	,	2508.1891	},
	{	412	,	2511.61962	},
	{	413	,	2515.048979	},
	{	414	,	2518.477178	},
	{	415	,	2521.904216	},
	{	416	,	2525.330094	},
	{	417	,	2528.754812	},
	{	418	,	2532.178369	},
	{	419	,	2535.600766	},
	{	420	,	2539.022002	},
	{	421	,	2542.442078	},
	{	422	,	2545.860994	},
	{	423	,	2549.278749	},
	{	424	,	2552.695344	},
	{	425	,	2556.110778	},
	{	426	,	2559.525052	},
	{	427	,	2562.938166	},
	{	428	,	2566.350119	},
	{	429	,	2569.760912	},
	{	430	,	2573.170545	},
	{	431	,	2576.579017	},
	{	432	,	2579.986328	},
	{	433	,	2583.39248	},
	{	434	,	2586.797471	},
	{	435	,	2590.201301	},
	{	436	,	2593.603971	},
	{	437	,	2597.005481	},
	{	438	,	2600.40583	},
	{	439	,	2603.805019	},
	{	440	,	2607.203048	},
	{	441	,	2610.599916	},
	{	442	,	2613.995624	},
	{	443	,	2617.390171	},
	{	444	,	2620.783558	},
	{	445	,	2624.175785	},
	{	446	,	2627.566851	},
	{	447	,	2630.956757	},
	{	448	,	2634.345503	},
	{	449	,	2637.733088	},
	{	450	,	2641.119513	},
	{	451	,	2644.504777	},
	{	452	,	2647.888881	},
	{	453	,	2651.271824	},
	{	454	,	2654.653607	},
	{	455	,	2658.03423	},
	{	456	,	2661.413692	},
	{	457	,	2664.791994	},
	{	458	,	2668.169136	},
	{	459	,	2671.545117	},
	{	460	,	2674.919938	},
	{	461	,	2678.293598	},
	{	462	,	2681.666098	},
	{	463	,	2685.037438	},
	{	464	,	2688.407617	},
	{	465	,	2691.776636	},
	{	466	,	2695.144495	},
	{	467	,	2698.511193	},
	{	468	,	2701.87673	},
	{	469	,	2705.241108	},
	{	470	,	2708.604325	},
	{	471	,	2711.966381	},
	{	472	,	2715.327277	},
	{	473	,	2718.687013	},
	{	474	,	2722.045588	},
	{	475	,	2725.403003	},
	{	476	,	2728.759258	},
	{	477	,	2732.114352	},
	{	478	,	2735.468286	},
	{	479	,	2738.821059	},
	{	480	,	2742.172672	},
	{	481	,	2745.523125	},
	{	482	,	2748.872417	},
	{	483	,	2752.220549	},
	{	484	,	2755.56752	},
	{	485	,	2758.913331	},
	{	486	,	2762.257982	},
	{	487	,	2765.601472	},
	{	488	,	2768.943802	},
	{	489	,	2772.284971	},
	{	490	,	2775.624981	},
	{	491	,	2778.963829	},
	{	492	,	2782.301518	},
	{	493	,	2785.638045	},
	{	494	,	2788.973413	},
	{	495	,	2792.30762	},
	{	496	,	2795.640667	},
	{	497	,	2798.972553	},
	{	498	,	2802.303279	},
	{	499	,	2805.632845	},
	{	500	,	2808.96125	},
};

//多阶滤波
static uint16_t orderFilter(uint16_t *array, uint8_t order)
{
	uint16_t average = 0;
	uint8_t averageCnt = 0;
	uint8_t i;
	
	for(i=0;i<order;i++)
	{
		average += (array[i] * (i+1));
		averageCnt += (i+1);
	}
	
	average /= averageCnt;
	return average;
}

uint16_t getADCValueAfterFilter(uint8_t channel)
{
	uint8_t i;
	
	for(i=0;i<FILTERORDER-1;i++)
	{
		arrayBuff[channel][i] = arrayBuff[channel][i+1];
	}
	arrayBuff[channel][FILTERORDER-1] = adcBuff[channel];
	
	return orderFilter(arrayBuff[channel], FILTERORDER);
}

//初始化PB8为输出口.并使能这个口的时钟		    
//蜂鸣器初始化
void NTCResitor_Init(void)
{
	uint16_t i;
	
	//初始化ADC
	Adc_Init(); 
	
	//开机更新缓冲区
	for(i=0;i<5000;i++);
	getADCValueAfterFilter(0);
	getADCValueAfterFilter(1);
	getADCValueAfterFilter(2);
	for(i=0;i<5000;i++);
	getADCValueAfterFilter(0);
	getADCValueAfterFilter(1);
	getADCValueAfterFilter(2);
	for(i=0;i<5000;i++);
	getADCValueAfterFilter(0);
	getADCValueAfterFilter(1);
	getADCValueAfterFilter(2);
	for(i=0;i<5000;i++);
	getADCValueAfterFilter(0);
	getADCValueAfterFilter(1);
	getADCValueAfterFilter(2);
}


void NTCResistorTask(void)
{
	uint8_t flag1, flag2, flag3;
	uint16_t i;
	
	adcTemp[0].adcVal = getADCValueAfterFilter(0);
	adcTemp[0].ntcResistor = (float)adcTemp[0].adcVal*PULLUPRESISTOR1/(float)(4096-adcTemp[0].adcVal);
	adcTemp[1].adcVal = getADCValueAfterFilter(1);
	adcTemp[1].ntcResistor = (float)adcTemp[1].adcVal*PULLUPRESISTOR2/(float)(4096-adcTemp[1].adcVal);
	adcTemp[2].adcVal = getADCValueAfterFilter(2);
	adcTemp[2].ntcResistor = (float)adcTemp[2].adcVal*PULLUPRESISTOR3/(float)(4096-adcTemp[2].adcVal);

	//cDebug("adcTemp[1].ntcResistor = %f\r\n", adcTemp[1].ntcResistor);
	
	flag1 = 0;
	flag2 = 0;
	flag3 = 0;
	for(i=0;i<550;i++)//SIZEOF(NTCResistor_50K3950_Table)-1     550
	{
		if(!flag1 && (adcTemp[0].ntcResistor > NTCResistor_50K3950_Table[i].resistorKOhm && adcTemp[0].ntcResistor <= NTCResistor_50K3950_Table[i+1].resistorKOhm))
		{
			adcTemp[0].temperature = (NTCResistor_50K3950_Table[i+1].temperature - NTCResistor_50K3950_Table[i].temperature)
							* (adcTemp[0].ntcResistor - NTCResistor_50K3950_Table[i].resistorKOhm)
							+ NTCResistor_50K3950_Table[i].temperature;
			//cDebug("adcTemp[0].temperature = %f\r\n", adcTemp[0].temperature);
			//SetTextFloat(STATUSPAGE_INDEX, STATUS_TEMPCUTOFF1_EDIT, adcTemp[0].temperature, 2, 1);
			if(pProjectMan->inStatusPageFlag)
			{
				xSemaphoreTake(pProjectMan->lcdUartSem, portMAX_DELAY);
				SetTextInt32(STATUSPAGE_INDEX, STATUS_TEMPCUTOFF1_EDIT, adcTemp[0].temperature, 1, 0);
				xSemaphoreGive(pProjectMan->lcdUartSem);
			}
			flag1 = 1;
		}
		if(!flag2 && (adcTemp[1].ntcResistor > NTCResistor_50K3950_Table[i].resistorKOhm && adcTemp[1].ntcResistor <= NTCResistor_50K3950_Table[i+1].resistorKOhm))
		{
			adcTemp[1].temperature = (NTCResistor_50K3950_Table[i+1].temperature - NTCResistor_50K3950_Table[i].temperature)
							* (adcTemp[1].ntcResistor - NTCResistor_50K3950_Table[i].resistorKOhm)
							+ NTCResistor_50K3950_Table[i].temperature;
			//cDebug("adcTemp[1].temperature = %f\r\n", adcTemp[1].temperature);
			//SetTextFloat(STATUSPAGE_INDEX, STATUS_TEMPCUTOFF2_EDIT, adcTemp[1].temperature, 2, 1);
			if(pProjectMan->inStatusPageFlag)
			{
				xSemaphoreTake(pProjectMan->lcdUartSem, portMAX_DELAY);
				SetTextInt32(STATUSPAGE_INDEX, STATUS_TEMPCUTOFF2_EDIT, adcTemp[1].temperature, 1, 0);
				xSemaphoreGive(pProjectMan->lcdUartSem);
			}
			flag2 = 1;
		}
		if(!flag3 && (adcTemp[2].ntcResistor > NTCResistor_50K3950_Table[i].resistorKOhm && adcTemp[2].ntcResistor <= NTCResistor_50K3950_Table[i+1].resistorKOhm))
		{
			adcTemp[2].temperature = (NTCResistor_50K3950_Table[i+1].temperature - NTCResistor_50K3950_Table[i].temperature)
							* (adcTemp[2].ntcResistor - NTCResistor_50K3950_Table[i].resistorKOhm)
							+ NTCResistor_50K3950_Table[i].temperature;
			//cDebug("adcTemp[2].temperature = %f\r\n", adcTemp[2].temperature);
			//SetTextFloat(STATUSPAGE_INDEX, STATUS_TEMPFUSING_EDIT, adcTemp[2].temperature, 2, 1);
			if(pProjectMan->inStatusPageFlag)
			{
				xSemaphoreTake(pProjectMan->lcdUartSem, portMAX_DELAY);
				SetTextInt32(STATUSPAGE_INDEX, STATUS_TEMPFUSING_EDIT, adcTemp[2].temperature, 1, 0);
				xSemaphoreGive(pProjectMan->lcdUartSem);
			}
			flag3 = 1;
		}
		if(flag1 && flag2 && flag3)
			break;
	}
}
